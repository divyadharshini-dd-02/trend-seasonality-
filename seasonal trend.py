import matplotlib.pyplot as plt

def estimate_trend(y, d):
    n = len(y)
    trend = [0]*n
    for t in range(n):
        if d % 2 == 1:  # odd d
            sum_y = sum(y[max(0, t-d//2):min(n, t+d//2+1)])
            count = min(t+1, n-t, d)
        else:  # even d
            sum_y = sum(y[max(0, t-d//2+1):min(n, t+d//2+1)])
            count = min(t+1, n-t, d)
        trend[t] = sum_y / count
    return trend

def estimate_seasonality(y, d, trend):
    n = len(y)
    seasonality = [0]*n
    for t in range(n):
        seasonality[t] = y[t] / trend[t]
    return seasonality

# Example usage:
y = [0.001122447,0.00100459,0.00140801,0.001488406,0.001500972,
0.001524228,
0.001695167,
0.002261346,
0.002109482,
0.00226759,
0.002484247,
0.003078112,
0.00303086,
0.002873795,
0.002969041,
0.003369981,
0.002199345,
0.001495428,
0.001111881,
0.001348111,
0.001161548,
0.00186455,
0.001506576,
0.001909153,
0.003304858,
0.003509958,
0.003776848,
0.005377047,
0.002270875,
0.002471637,
0.002699788,
0.002850534,
0.003258011,
0.004373836,
0.005636822,
0.006378874,
0.006655864,
0.006947874,
0.00834941,
0.008444488,
0.008378466,
0.008001746,
0.001108944,
0.001201651,
0.001084358,
0.001063685,
0.000885349,
0.000707698,
0.000905599,
0.001208838,
0.001289587,
0.001762999,
0.002628307,
0.003064919,
0.003250133,
0.004690593,
0.000201425,
0.000126654,
0.000274953,
0.000266024,
0.000456881,
0.000423337,
0.000491214,
0.000502567,
0.000828954,
0.001172058,
0.001649886,
0.002151673,
0.002231008,
0.00329785,
0.001319511,
0.001502185,
0.001691978,
0.001761905,
0.001807576,
0.001995036,
0.00288478,
0.003791548,
0.004035236,
0.005166712,
0.006511296,
0.007312085,
0.007246542,
0.006602731,
0.00424566,
0.005148678,
0.003113125,
0.002730537,
0.002941842,
0.003692815,
0.004682261,
0.003780954,
0.003128285,
0.002983391,
0.002272403,
0.001502706,
0.001403184,
0.000339471,
0.002283925,
0.002649481,
0.002257459,
0.00249821,
0.002933009,
0.002711925,
0.003394135,
0.004791607,
0.006391706,
0.00702889,
0.010425118,
0.0137198,
0.01416273,
0.018381352,
0.004346111,
0.004413511,
0.004056658,
0.003710312,
0.003827929,
0.00396499,
0.003905155,
0.00524499,
0.006101649,
0.006175857,
0.00779671,
0.009780705,
0.009889675,
0.011106953,
0.000982243,
0.000980404,
0.00119608,
0.000912026,
0.000841508,
0.000902496,
0.000991503,
0.001233358,
0.001649925,
0.002127563,
0.002654584,
0.003464364,
0.003696512,
0.005343311,
0.001781614,
0.001676936,
0.001565778,
0.001311345,
0.001277322,
0.001020034,
0.00128763,
0.000882858,
0.001553406,
0.001555141,
0.00174327,
0.002128572,
0.002079043,
0.00159803,
0.002893104,
0.003535835,
0.005342451,
0.008220346,
0.010170789,
0.010380907,
0.009468751,
0.009633996,
0.01140285,
0.010486257,
0.011417226,
0.010247762,
0.010337182,
0.01149109,
0.006062483,
0.005036757,
0.00468445,
0.005397502,
0.005443149,
0.006410452,
0.006937305,
0.010242677,
0.009203283,
0.012476109,
0.014153101,
0.016524874,
0.017317615,
0.022422465,
0.000438665,
0.000383293,
0.000274535,
0.000412789,
0.000359197,
0.000343423,
0.0004298,
0.000561791,
0.000715116,
0.000553139,
0.000645169,
0.000658235,
0.000640662,
0.000589835,
0.000495991,
0.000428715,
0.000742979,
0.00084585,
0.000638999,
0.000948893,
0.001214134,
0.001479702,
0.002289931,
0.002417022,
0.003776853,
0.00569126,
0.005792556,
0.006674992,
0.004954967,
0.001040266,
0.004700874,
0.004536888,
0.008430674,
0.00604934,
0.00789873,
0.00484051,
0.007794886,
0.008713199,
0.006593086,
0.003969293,
0.003926754,
0.003223797,
0.000647524,
0.000831061,
0.000840536,
0.001295697,
0.001177476,
0.000928458,
0.00166776,
0.001725321,
0.001595008,
0.002098732,
0.002252764,
0.002896845,
0.002846251,
0.00287451,
0.005981205,
0.005132046,
0.006648985,
0.00465314,
0.004875233,
0.005366389,
0.006834065,
0.00683578,
0.006667358,
0.00661903,
0.007991847,
0.005440566,
0.005568049,
0.006600924,
0.001612436,
0.001681373,
0.001802432,
0.001804675,
0.001828777,
0.002196149,
0.002462314,
0.002465027,
0.002659987,
0.002506448,
0.002220291,
0.001613459,
0.001595549,
0.001474744,
0.000599453,
0.000582713,
0.000741978,
0.00048099,
0.000469549,
0.000453584,
0.000593613,
0.000885246,
0.000996499,
0.000820144,
0.001501205,
0.001944548,
0.00198024,
0.002316462,
0.000320635,
0.000432553,
0.000479102,
0.000505533,
0.000451232,
0.000463861,
0.000449687,
0.000456603,
0.000387959,
0.000561546,
0.000598558,
0.00042064,
0.000418945,
0.000171238,
0.001367783,
0.001856362,
0.002226353,
0.002402444,
0.002842985,
0.003585611,
0.004109801,
0.005154417,
0.005133521,
0.005560242,
0.006549481,
0.00587649,
0.005703832,
0.003814514,
0.000275639,
0.00056843,
0.000595797,
0.00060238,
0.000558457,
0.000548747,
0.000586249,
0.00107483,
0.001095283,
0.001715756,
0.002299691,
0.003024083,
0.003141024,
0.00446716,
0.000649304,
0.000719572,
0.000699874,
0.000917883,
0.000909736,
0.000854305,
0.001069047,
0.001146821,
0.001704605,
0.002554471,
0.003933366,
0.005856768,
0.005998089,
0.007510407,
0.000365426,
0.00034658,
0.000381256,
0.000513963,
0.000596078,
0.000632857,
0.000843331,
0.001094663,
0.001453268,
0.001623433,
0.002254278,
0.002263918,
0.00224805,
0.002097603,
0.001599978,
0.001553453,
0.001833114,
0.002154475,
0.002712126,
0.003361039,
0.004861127,
0.00523957,
0.004806393,
0.005536929,
0.005001779,
0.004234111,
0.004080395,
0.003166772,
0.000776141,
0.000780763,
0.000742009,
0.00111444,
0.001241864,
0.001396807,
0.00176903,
0.001813946,
0.001750299,
0.002004617,
0.001372248,
0.001099319,
0.001094086,
0.001312274,
0.01082803,
0.011238966,
0.010622167,
0.008931018,
0.008667393,
0.007833496,
0.008211543,
0.009111187,
0.009840729,
0.011673247,
0.013613031,
0.014533797,
0.015519165,
0.023024304,
0.000283844,
0.000190376,
0.000297547,
0.000313902,
0.000316274,
0.000394776,
0.000418442,
0.000520912,
0.000706799,
0.000775136,
0.001210643,
0.001672583,
0.001755193,
0.002564181,
0.012218312,
0.01308782,
0.011795697,
0.011104289,
0.009847728,
0.01081537,
0.010348632,
0.011799295,
0.013487599,
0.014321391,
0.013989284,
0.016592866,
0.016954012,
0.019525487,
0.005269548,
0.004966975,
0.005647434,
0.005970942,
0.005238361,
0.005570201,
0.005400448,
0.005581952,
0.007731209,
0.007701324,
0.009704736,
0.016949276,
0.018967163,
0.032102767,
0.000612743,
0.000258504,
0.000545846,
0.000773399,
0.000724416,
0.00084493,
0.000728782,
0.000988289,
0.001050785,
0.0016902,
0.00216623,
0.003217161,
0.003285127,
0.004156222,
0.005324914,
0.005450534,
0.005707197,
0.005262228,
0.006083361,
0.006552733,
0.007480927,
0.007224821,
0.008455657,
0.011622772,
0.012496449,
0.019589972,
0.020571183,
0.02822981,
0.000351396,
0.000318825,
0.000367898,
0.000523011,
0.000636293,
0.000885541,
0.001701335,
0.002690996,
0.003199434,
0.004245758,
0.00524408,
0.006156058,
0.006403509,
0.008966469,
0.003717141,
0.003818139,
0.003137417,
0.002150423,
0.001940379,
0.001808747,
0.002117662,
0.002404546,
0.003146334,
0.003853372,
0.0055318,
0.007576077,
0.007413722,
0.006515729,
0.00464553,
0.004884197,
0.004839784,
0.004941096,
0.005214854,
0.005947603,
0.006740771,
0.007630806,
0.007407452,
0.008533874,
0.007955897,
0.006708254,
0.006357314,
0.002609875,
0.001894618,
0.001901772,
0.001408132,
0.001376149,
0.001576984,
0.001900977,
0.00281386,
0.003332853,
0.003499269,
0.003754715,
0.004312283,
0.004943629,
0.004841459,
0.003956646,
0.000238248,
0.000351035,
0.000366418,
0.000360909,
0.000374053,
0.000371988,
0.000446944,
0.000651343,
0.000704996,
0.001355973,
0.001564088,
0.002224984,
0.002230843,
0.002551058,
0.002012151,
0.001911436,
0.002156225,
0.002098109,
0.002006677,
0.002114917,
0.002901481,
0.003726973,
0.003899494,
0.004821324,
0.006424684,
0.007240389,
0.007240895,
0.007246257,
0.003307473,
0.003809621,
0.004403657,
0.004112029,
0.003510799,
0.003914919,
0.004599627,
0.005818165,
0.005829091,
0.007820482,
0.010103292,
0.014992197,
0.015119525,
0.016382456,
0.005483062,
0.004942092,
0.005972404,
0.005437053,
0.007133638,
0.007448476,
0.008180684,
0.007816346,
0.00823343,
0.008879502,
0.007401057,
0.005638996,
0.005355047,
0.003122753,
0.000319048,
0.000484371,
0.000546008,
0.000707906,
0.000885847,
0.001104972,
0.001712283,
0.002046786,
0.002020368,
0.001975815,
0.002285536,
0.002376342,
0.002279444,
0.001454984,
0.000928221,
0.000784913,
0.000767355,
0.000747448,
0.00084965,
0.000733192,
0.000967847,
0.001177721,
0.001560843,
0.001564947,
0.00234063,
0.003661431,
0.003633371,
0.003503944,
0.035773583,
0.033579871,
0.02226796,
0.019233868,
0.016676204,
0.015635561,
0.015905512,
0.015460062,
0.018701101,
0.023877496,
0.020868978,
0.028537508,
0.031020455,
0.045827072,
0.000868829,
0.001153241,
0.001175593,
0.000983632,
0.001007043,
0.000821366,
0.000908736,
0.001138024,
0.001425748,
0.001142223,
0.00169569,
0.002171536,
0.002210222,
0.002531158,
0.001196083,
0.001097323,
0.001028865,
0.000891398,
0.000669523,
0.000633736,
0.000647475,
0.000614187,
0.000718094,
0.000448346,
0.000409007,
0.000300391,
0.00026249,
0.004424216,
0.004758364,
0.003896111,
0.004258427,
0.003974272,
0.004460995,
0.004574123,
0.00534231,
0.00557675,
0.0062173,
0.006809997,
0.007269433,
0.007150277,
0.006590624,
0.000133276,
0.000187507,
0.000274062,
0.000435946,
0.00041486,
0.000489877,
0.000686184,
0.000975461,
0.001167607,
0.001468555,
0.001928751,
0.002609366,
0.002548786,
0.002336184,
0.000418282,
0.000364307,
0.000420291,
0.000425777,
0.000546344,
0.000609479,
0.000763043,
0.000927934,
0.001276505,
0.001787102,
0.002204999,
0.00283368,
0.002772907,
0.002348889,
0.001582247,
0.001355969,
0.001387406,
0.001499435,
0.001421856,
0.001474548,
0.001598715,
0.002171709,
0.002333312,
0.003457291,
0.004024356,
0.005842838,
0.005828939,
0.005944076,
0.000631612,
0.000672674,
0.000696772,
0.000682259,
0.000642663,
0.000780838,
0.001414851,
0.001968949,
0.002250914,
0.00245079,
0.002619343,
0.003675785,
0.004008812,
0.007416465,
0.000292185,
0.00070979,
0.001080809,
0.001038325,
0.00116672,
0.001002323,
0.000781037,
0.001062423,
0.000803525,
0.001224111,
0.001072311,
0.001444145,
0.001374672,
0.000817949,
0.000877719,
0.001205917,
0.001100071,
0.001228192,
0.00163771,
0.002204827,
0.003514539,
0.004246838,
0.003776284,
0.004485665,
0.004926751,
0.004932775,
0.004866844,
0.004354809,
0.016758166,
0.013722787,
0.014583995,
0.012194498,
0.012216954,
0.012630523,
0.015277062,
0.016033344,
0.01858899,
0.014719711,
0.012821614,
0.013226325,
0.013489231,
0.016107565,
0.00416428,
0.004209952,
0.004086478,
0.004891893,
0.005483069,
0.008033603,
0.011224818,
0.012675566,
0.011722132,
0.01233986,
0.012719657,
0.010350432,
0.010025953,
0.006816886,
0.001123837,
0.001302673,
0.001040588,
0.00121601,
0.001021382,
0.001287873,
0.001283288,
0.002154216,
0.002345448,
0.003018619,
0.003972723,
0.005076126,
0.005480257,
0.008941458,
0.012460695,
0.012554072,
0.008588882,
0.007537724,
0.006009908,
0.00557423,
0.00637668,
0.008364968,
0.007791783,
0.010401745,
0.012166269,
0.014856138,
0.01533205,
0.020142907,
0.003231255,
0.004162713,
0.004697483,
0.005200699,
0.005488935,
0.005772133,
0.005829651,
0.005552218,
0.00535302,
0.004721059,
0.004150234,
0.002977869,
0.002865022,
0.001857968,
0.003628016,
0.004048371,
0.004302833,
0.004560794,
0.004798308,
0.006093671,
0.006961001,
0.008663346,
0.008452065,
0.007575498,
0.008788514,
0.006747399,
0.006513039,
0.005010879,
0.008368273,
0.007087211,
0.006624957,
0.007533548,
0.007659176,
0.006830387,
0.007335874,
0.008340256,
0.010792469,
0.011567928,
0.015840504,
0.020661492,
0.021033539,
0.024800921,
0.000563444,
0.000721059,
0.000956178,
0.001092575,
0.00117967,
0.001145657,
0.001765944,
0.00234501,
0.002263403,
0.002646106,
0.002436796,
0.003117504,
0.003188379,
0.003472797,
0.000734053,
0.000746207,
0.000696119,
0.000630086,
0.000508523,
0.000591327,
0.000717244,
0.000968267,
0.000729738,
0.001201114,
0.001229399,
0.001687411,
0.001690253,
0.001633845,
0.00562415,
0.006460093,
0.007246181,
0.008221182,
0.00893506,
0.009593239,
0.009436862,
0.009583562,
0.009230389]
  # Time series data
d = 7  # Number of seasons (odd)
# d = 10  # Number of seasons (even)

trend = estimate_trend(y, d)
seasonality = estimate_seasonality(y, d, trend)

# Plotting
plt.figure(figsize=(10, 6))

plt.subplot(3, 1, 1)
plt.plot(y, label='Original Time Series')
plt.legend()

plt.subplot(3, 1, 2)
plt.plot(trend, label='Trend Component')
plt.legend()

plt.subplot(3, 1, 3)
plt.plot(seasonality, label='Seasonality Component')
plt.legend()

plt.tight_layout()
plt.show()

